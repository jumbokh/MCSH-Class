#include <SPI.h>
#include <Wire.h>
#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>

#define SCREEN_WIDTH 128 // OLED 寬度像素
#define SCREEN_HEIGHT 64 // OLED 高度像素

// 設定OLED
#define OLED_RESET     4 // Reset pin # (or -1 if sharing Arduino reset pin)
Adafruit_SSD1306 display(SCREEN_WIDTH, SCREEN_HEIGHT, &Wire, OLED_RESET);

//自訂圖形，從Image2LCD轉過來的，尺寸是128x48，少掉的16個像素是上方黃色區塊(假設是用藍黃雙色的OLED)
//本範例為了在上方區塊顯示文字，所以圖形就沒有涵蓋整個高度

static const unsigned char PROGMEM logo_bmp[] =
{ 0X00,0X01,0X40,0X00,0X40,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X3E,0X00,0X00,0X40,0X00,0X00,
0X30,0X00,0XFF,0X80,0X01,0X9F,0X30,0X00,0X38,0X01,0XFF,0XC0,0X03,0XBF,0XB8,0X00,
0X38,0X03,0XC3,0XC0,0X03,0XFB,0XB8,0X00,0X3B,0XFF,0X9F,0X9F,0X1F,0XDB,0XB8,0X1E,
0X3B,0XFF,0XFF,0XBF,0XBF,0X87,0XB8,0X3F,0X3B,0XBB,0X9F,0XBB,0XBF,0X8F,0XB8,0X39,
0X3B,0XBB,0X9F,0XBB,0XBF,0X9E,0XB8,0X38,0X3B,0XBB,0XBF,0XBB,0XB8,0X3C,0XB8,0X38,
0X3B,0XBB,0XBB,0XBB,0XBB,0X38,0XB8,0X3B,0X3B,0XBF,0X9F,0XBF,0XBF,0XBF,0XFF,0X9F,
0X19,0X9F,0X8F,0X9F,0XBF,0X1F,0XFF,0XCF,0X00,0X0F,0X00,0X33,0XBC,0X00,0XE0,0X00,
0X00,0X0F,0X00,0X1F,0XBC,0X01,0XE0,0X00,0X00,0X0F,0X00,0X1F,0X3C,0X01,0XE0,0X00,
0X00,0X07,0X80,0X3C,0X3C,0X03,0XE0,0X00,0X00,0X07,0X80,0X3C,0X3E,0X03,0XC0,0X00,
0X00,0X07,0XC0,0X3C,0X1F,0X07,0XC0,0X00,0X00,0X03,0XE0,0X7C,0X1F,0X9F,0X80,0X00,
0X1F,0XC1,0XF0,0XF8,0X0F,0XFF,0X03,0XF0,0X3F,0XE1,0XFF,0XF0,0X07,0XFF,0X0F,0XF8,
0X7F,0XF8,0XFF,0XF0,0X03,0XFC,0X1F,0XFC,0X7F,0XF8,0X3F,0XC0,0X00,0XF0,0X3F,0XFE,
0X78,0X7C,0X0F,0X00,0X00,0X00,0X7E,0X1E,0XF0,0X3E,0X00,0X00,0X00,0X00,0X7C,0X1F,
0XF0,0X1E,0X00,0X0F,0XF8,0X00,0X78,0X0F,0XF0,0X1E,0X00,0X1F,0XFC,0X00,0XF0,0X0F,
0XF0,0X0F,0X00,0X3F,0XFE,0X00,0XF0,0X0F,0XF0,0X0F,0X00,0X7F,0XFF,0X00,0XF0,0X0F,
0XF8,0X0F,0X00,0XF8,0X0F,0X80,0XE0,0X0F,0X78,0X0F,0X01,0XF0,0X0F,0X80,0XE0,0X1E,
0X7C,0X0F,0X03,0XE0,0X07,0XC0,0XE0,0X1E,0X7C,0X0F,0X03,0XC0,0X03,0XC0,0XF0,0X3E,
0X3F,0X1E,0X07,0XC0,0X03,0XE0,0XF0,0X7C,0X1F,0XFE,0X0F,0X80,0X01,0XF0,0XF8,0XFC,
0X0F,0XFC,0X1F,0X00,0X00,0XF0,0X7F,0XF8,0X07,0XF8,0X3F,0X00,0X00,0XF8,0X7F,0XF0,
0X01,0XF0,0X7E,0X00,0X00,0X7C,0X1F,0XC0,0X00,0X00,0XFC,0X00,0X00,0X3E,0X0F,0X80,
0X00,0X01,0XF8,0X00,0X00,0X1F,0X00,0X00,0X00,0X03,0XF0,0X00,0X00,0X1F,0X80,0X00,
0X00,0X07,0XE0,0X00,0X00,0X0F,0XC0,0X00,0X00,0X0F,0XC0,0X00,0X00,0X07,0XE0,0X00,
0X00,0X1F,0X00,0X00,0X00,0X03,0XE0,0X00,0X00,0X1F,0X00,0X00,0X00,0X01,0XF0,0X00,
0X00,0X1E,0X00,0X00,0X00,0X00,0XF8,0X00,0X00,0X3C,0X00,0X00,0X00,0X00,0X78,0X00,
0X00,0X3C,0X00,0X00,0X00,0X00,0X78,0X00,0X00,0X78,0X00,0X00,0X00,0X00,0X78,0X00,
0X00,0X78,0X00,0X00,0X00,0X00,0X78,0X00,0X00,0X78,0X00,0X00,0X00,0X00,0X78,0X00,
0X00,0X3C,0X00,0X00,0X00,0X00,0X78,0X00,0X00,0X3E,0X00,0X3F,0XF8,0X00,0X78,0X00,
0X00,0X3F,0X03,0XFF,0XFF,0X80,0XF8,0X00,0X00,0X1F,0XFF,0XFF,0XFF,0XFF,0XF0,0X00,
0X00,0X0F,0XFF,0XFF,0XFF,0XFF,0XE0,0X00,0X00,0X07,0XFF,0XC0,0X07,0XFF,0XC0,0X00,
0X00,0X01,0XFC,0X00,0X00,0X7F,0X80,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,0X00,
};



void setup() {
  Serial.begin(9600);

  // 偵測是否安裝好OLED了
  if(!display.begin(SSD1306_SWITCHCAPVCC, 0x3C)) { // 一般1306 OLED的位址都是0x3C
    Serial.println(F("SSD1306 allocation failed"));
    for(;;); // Don't proceed, loop forever
  }

  // 顯示Adafruit的LOGO，算是開機畫面
  display.display();
  delay(1000); // 停1秒

  // 清除畫面
  display.clearDisplay();

  testdrawstyles();    // 測試文字

  testdrawbitmap();    // 顯示圖形

}

void loop() {
}

void testdrawstyles(void) {
  display.clearDisplay();
  display.setTextSize(2);             // 設定文字大小
  display.setTextColor(1);        // 1:OLED預設的顏色(這個會依該OLED的顏色來決定)
  display.setCursor(0,0);             // 設定起始座標
  display.print("Hello OLED");        // 要顯示的字串
  display.display();                  // 要有這行才會把文字顯示出來
  delay(1000);
}

void testdrawbitmap(void) {
  //display.clearDisplay();
  //顯示圖形，x,y,圖形文字,寬,高,1:OLED預設的顏色(這個會依該OLED的顏色來決定)
  display.drawBitmap(0,16,logo_bmp, 128, 48, 1);
  display.display();  // 要有這行才會把文字顯示出來
  delay(1000);
}
